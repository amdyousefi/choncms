<script type="text/javascript">
CyrToLat = {
	_cyr: "АБВГДЃЕЖЗЅИЈКЛЉМНЊОПРСТЌУФХЦЧЏШабвгдѓежзѕијклљмнњопрстќуфхцчџш",
	_cyr_lat_repl: [ "A", "B", "V", "G", "D", "Gj", "E", "Zh",
	     			"Z", "Dz", "I", "J", "K", "L", "Lj", "M", "N", "Nj", "O", "P", "R",
	    			"S", "T", "Kj", "U", "F", "H", "C", "Ch", "Dzh", "Sh", "a", "b",
	    			"v", "g", "d", "gj", "e", "zh", "z", "dz", "i", "j", "k", "l",
	    			"lj", "m", "n", "nj", "o", "p", "r", "s", "t", "kj", "u", "f", "h",
	    			"c", "ch", "dzh", "sh"
	],
	
	convert: function(s) {
		var rv = "";
		for(var i=0; i<s.length; i++) {
			var idx = this._cyr.indexOf(s[i]);
			rv += idx>=0 ? this._cyr_lat_repl[idx] : s[i]; 
		}
		return rv;
	}
}

<!--
node = {
	type: '$type',
	pid: '$pid'
}
suffix = '$!suffix';

function createNode() {
	node.name = jQuery('input[name=name]').val();
	node.props=[];
	#foreach($o in $properties.entrySet())
		node.props.push({name: '$o.key', value: '$o.value' });
	#end
	node.props.push({name: 'title', value: jQuery('input[name=title]').val()});
	jQuery.post('createNode.ajax', {node: JSON.encode(node)}, function(resp) {
		var r = JSON.decode(resp);
		if(r.msg=='OK') {
			console.log(r);
			document.location.href = '$nextAction' + '?path=' + r.node.attr.path;
		} else {
			alert(r.msg)
		}
	});
}

jQuery(function() {
	jQuery('input[name=title]').keyup(function() {
		var val = jQuery(this).val().toLowerCase();
		val = CyrToLat.convert(val);
		val = val.replace(/[^a-z0-9]/g, ' ').trim();
		val = val.replace(/ /g, '-').trim();
		if(suffix) val+='.'+suffix;
		jQuery('input[name=name]').val(val);
	});
});
//-->
</script>
<div class="title">$pageTitle</div>
<div style="clear: both;"></div>
<table cellspacing="10">
	<tr>
		<td colspan="2">
			<div class="note">$pageNote</div></td>
	</tr>
	<tr>
		<td>URL Friendly Name:
			<div class="note">Based on your title url friendly name will be
				autogenerated</div></td>
		<td><input type="text" name="name" disabled="disabled" /></td>
	</tr>
	<tr valign="top">
		<td>Title:</td>
		<td><input type="text" name="title" />
		</td>
	</tr>
	<tr>
		<td colspan="2" align="right">
			<div class="note">Node initially will be created in your home
				dir. After edit you can publish to public folder</div></td>
	</tr>
	<tr>
		<td colspan="2" align="right"><input type="button"
			value="Create &nbsp;&nbsp;&gt;&gt;" onclick="createNode()"/></td>
	</tr>
</table>
